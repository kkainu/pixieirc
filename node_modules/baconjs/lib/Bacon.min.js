// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I=[].slice,q={}.hasOwnProperty,R=function(e,t){function r(){this.constructor=e}for(var n in t)q.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},U=function(e,t){return function(){return e.apply(t,arguments)}};(F=this.jQuery||this.Zepto)!=null&&(F.fn.asEventStream=function(t,n,r){var i;return r==null&&(r=j.id),S(n)&&(r=n,n=null),i=this,new o(function(s){var o,u;return o=function(){var t,n;t=1<=arguments.length?I.call(arguments,0):[],n=s(C(r.apply(null,t)));if(n===e.noMore)return u()},u=function(){return i.off(t,n,o)},i.on(t,n,o),u})}),e=this.Bacon={},e.fromPromise=function(t){return new e.EventStream(function(e){var n,s;return s=function(t){return e(new a(t)),e(new r)},n=function(t){return e(new i(t)),e(new r)},t.then(s,n),k})},e.noMore="veggies",e.more="moar bacon!",e.later=function(t,n){return e.sequentially(t,[n])},e.sequentially=function(t,n){var r,i;return r=-1,i=function(){return r++,r<n.length?_(n[r]):g()},e.fromPoll(t,i)},e.repeatedly=function(t,n){var r,i;return r=-1,i=function(){return r++,_(n[r%n.length])},e.fromPoll(t,i)},e.fromCallback=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t=T(t,e),new o(function(e){var n;return n=function(t){return e(C(t)),e(g())},t(n),k})},e.fromPoll=function(t,n){return new o(function(r){var i,s,o;return s=void 0,i=function(){var t,i;i=n(),t=r(i);if(t===e.noMore||i.isEnd())return o()},o=function(){return clearInterval(s)},s=setInterval(i,t),o})},e.fromEventTarget=function(t,n,r){return r==null&&(r=function(e){return e}),new o(function(i){var s,o;return s=function(){var t;t=i(C(r.apply(r,arguments)));if(t===e.noMore)return o()},t.addEventListener?(o=function(){return t.removeEventListener(n,s,!1)},t.addEventListener(n,s,!1)):(o=function(){return t.removeListener(n,s)},t.addListener(n,s)),o})},e.interval=function(t,n){var r;return n==null&&(n={}),r=function(){return C(n)},e.fromPoll(t,r)},e.constant=function(e){return new c(O([e],b))},e.never=function(){return e.fromArray([])},e.once=function(t){return e.fromArray([t])},e.fromArray=function(e){return new o(O(e,C))},O=function(e,t){return function(n){var r,i,s;for(i=0,s=e.length;i<s;i++)r=e[i],n(t(r));return n(g()),k}},e.combineAll=function(e,t){var n,r,i,s,o;r=j.head(e),o=j.tail(e);for(i=0,s=o.length;i<s;i++)n=o[i],r=t(r,n);return r},e.mergeAll=function(t){return e.combineAll(t,function(e,t){return e.merge(t)})},e.combineAsArray=function(){var t,n,r,i,s,o,u;i=arguments[0],t=2<=arguments.length?I.call(arguments,1):[],i instanceof Array||(i=[i].concat(t));if(i.length){r=j.head(i).toProperty().map(function(e){return[e]}),u=j.tail(i);for(s=0,o=u.length;s<o;s++)n=u[s],r=r.combine(n,function(e,t){return e.concat([t])});return r}return e.constant([])},e.combineWith=function(t,n){return e.combineAll(t,function(e,t){return e.toProperty().combine(t,n)})},e.combineTemplate=function(t){var n,r,i,s,o,u,a,f,c,h;return a=[],h=[],u=function(e){return e[e.length-1]},c=function(e,t,n){return u(e)[t]=n},n=function(e,t){return function(n,r){return c(n,e,r[t])}},o=function(e,t){return function(n,r){return c(n,e,t)}},f=function(e){return e instanceof Array?[]:{}},i=function(e,t){var r,i;return t instanceof l?(h.push(t),a.push(n(e,h.length-1))):typeof t=="object"?(i=function(e){return function(n,r){var i;return i=f(t),c(n,e,i),n.push(i)}},r=function(e,t){return e.pop()},a.push(i(e)),s(t),a.push(r)):a.push(o(e,t))},s=function(e){return j.each(e,i)},s(t),r=function(e){var n,r,i,s,o;i=f(t),n=[i];for(s=0,o=a.length;s<o;s++)r=a[s],r(n,e);return i},e.combineAsArray(h).map(r)},e.latestValue=function(e){var t,n=this;return t=void 0,e.subscribe(function(e){if(e.hasValue())return t=e.value}),function(){return t}},s=function(){function e(){}return e.prototype.isEvent=function(){return!0},e.prototype.isEnd=function(){return!1},e.prototype.isInitial=function(){return!1},e.prototype.isNext=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.hasValue=function(){return!1},e.prototype.filter=function(e){return!0},e.prototype.getOriginalEvent=function(){return this.sourceEvent!=null?this.sourceEvent.getOriginalEvent():this},e.prototype.onDone=function(e){return e()},e}(),a=function(e){function t(e,t){this.value=e}return R(t,e),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.fmap=function(e){return this.apply(e(this.value))},t.prototype.apply=function(e){return C(e,this.getOriginalEvent())},t.prototype.filter=function(e){return e(this.value)},t.prototype.describe=function(){return this.value},t}(s),u=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return R(t,e),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(e){return b(e,this.getOriginalEvent())},t}(a),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return R(t,e),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.describe=function(){return"<end>"},t}(s),i=function(e){function t(e){this.error=e}return R(t,e),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.describe=function(){return"<error> "+this.error},t}(s),l=function(){function t(){this.flatMapLatest=U(this.flatMapLatest,this),this["switch"]=U(this["switch"],this),this.scan=U(this.scan,this),this.takeUntil=U(this.takeUntil,this),this.assign=this.onValue}return t.prototype.onValue=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t=T(t,e),this.subscribe(function(e){if(e.hasValue())return t(e.value)})},t.prototype.onValues=function(e){return this.onValue(function(t){return e.apply(null,t)})},t.prototype.onError=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t=T(t,e),this.subscribe(function(e){if(e.isError())return t(e.error)})},t.prototype.onEnd=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t=T(t,e),this.subscribe(function(e){if(e.isEnd())return t()})},t.prototype.errors=function(){return this.filter(function(){return!1})},t.prototype.filter=function(){var t,n;return n=arguments[0],t=2<=arguments.length?I.call(arguments,1):[],n=T(n,t),this.withHandler(function(t){return t.filter(n)?this.push(t):e.more})},t.prototype.takeWhile=function(){var t,n;return n=arguments[0],t=2<=arguments.length?I.call(arguments,1):[],n=T(n,t),this.withHandler(function(t){return t.filter(n)?this.push(t):(this.push(g()),e.noMore)})},t.prototype.endOnError=function(){return this.withHandler(function(e){return e.isError()?(this.push(e),this.push(g())):this.push(e)})},t.prototype.take=function(t){return this.withHandler(function(n){return n.hasValue()?t===1?(this.push(n),this.push(g()),e.noMore):(t--,this.push(n)):this.push(n)})},t.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t=T(t,e),this.withHandler(function(e){return this.push(e.fmap(t))})},t.prototype.mapError=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t=T(t,e),this.withHandler(function(e){return e.isError()?this.push(C(t(e.error))):this.push(e)})},t.prototype["do"]=function(){var e;return e=1<=arguments.length?I.call(arguments,0):[],this.doAction.apply(this,e)},t.prototype.doAction=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t=T(t,e),this.withHandler(function(e){return e.hasValue()&&t(e.value),this.push(e)})},t.prototype.takeUntil=function(t){var n;return n=this,this.withSubscribe(function(r){var i,s,o,u,a,f;return f=!1,u=k,a=k,o=function(){return u(),a(),f=!0},i=function(t){return t.isEnd()?(a(),r(t),e.noMore):(t.getOriginalEvent().onDone(function(){var n;if(!f){n=r(t);if(n===e.noMore)return o()}}),e.more)},s=function(t){return t.isError()?e.more:t.isEnd()?e.noMore:(u(),r(g()),e.noMore)},u=n.subscribe(i),f||(a=t.subscribe(s)),o})},t.prototype.skip=function(t){return this.withHandler(function(n){return n.hasValue()?t>0?(t--,e.more):this.push(n):this.push(n)})},t.prototype.distinctUntilChanged=function(){return this.skipDuplicates()},t.prototype.skipDuplicates=function(e){return e==null&&(e=function(e,t){return e===t}),this.withStateMachine(void 0,function(t,n){return n.hasValue()?e(t,n.value)?[t,[]]:[n.value,[n]]:[t,[n]]})},t.prototype.withStateMachine=function(t,n){var r;return r=t,this.withHandler(function(t){var i,s,o,u,a,f,l;i=n(r,t),s=i[0],u=i[1],r=s,a=e.more;for(f=0,l=u.length;f<l;f++){o=u[f],a=this.push(o);if(a===e.noMore)return a}return a})},t.prototype.scan=function(t,n){var r,i,s=this;return n=M(n),r=H(t),i=function(t){var i,o;return i=!1,o=s.subscribe(function(s){return s.hasValue()?i&&s.isInitial()?e.more:(i=!0,r=new p(n(r.getOrElse(void 0),s.value)),t(s.apply(r.get()))):(s.isEnd()&&(i=!0),t(s))}),i||r.forEach(function(n){var r;r=t(b(n));if(r===e.noMore)return o(),o=k}),o},new c((new h(i)).subscribe)},t.prototype.diff=function(e,t){return t=M(t),this.scan([e],function(e,n){return[n,t(e[0],n)]}).filter(function(e){return e.length===2}).map(function(e){return e[1]})},t.prototype.flatMap=function(t){var n;return n=this,new o(function(r){var i,s,o,u,a,f;return s=[],o=!1,f=function(){},a=function(){var e,t,n;f();for(t=0,n=s.length;t<n;t++)e=s[t],e();return s=[]},i=function(){if(o&&s.length===0)return r(g())},u=function(n){var u,f,l,c,h;if(n.isEnd())return o=!0,i();if(n.isError())return r(n);u=t(n.value),h=void 0,f=!1,c=function(){return h!=null&&A(h,s),i()},l=function(t){var n;return t.isEnd()?(c(),f=!0,e.noMore):(n=r(t),n===e.noMore&&a(),n)},h=u.subscribe(l);if(!f)return s.push(h)},f=n.subscribe(u),a})},t.prototype["switch"]=function(){var e;return e=1<=arguments.length?I.call(arguments,0):[],this.flatMapLatest.apply(this,e)},t.prototype.flatMapLatest=function(e){var t,n=this;return t=this.toEventStream(),t.flatMap(function(n){return e(n).takeUntil(t)})},t.prototype.not=function(){return this.map(function(e){return!e})},t.prototype.log=function(){return this.subscribe(function(e){return console.log(e.describe())}),this},t.prototype.slidingWindow=function(e){return this.scan([],function(t,n){return t.concat([n]).slice(-e)})},t}(),o=function(t){function r(e){var t;r.__super__.constructor.call(this),t=new n(e),this.subscribe=t.subscribe,this.hasSubscribers=t.hasSubscribers}return R(r,t),r.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t instanceof c?t.sampledBy(this,y):r.__super__.map.apply(this,[t].concat(I.call(e)))},r.prototype.filter=function(){var e,t;return t=arguments[0],e=2<=arguments.length?I.call(arguments,1):[],t instanceof c?t.sampledBy(this,function(e,t){return[e,t]}).filter(function(e){var t,n;return t=e[0],n=e[1],t}).map(function(e){var t,n;return t=e[0],n=e[1],n}):r.__super__.filter.apply(this,[t].concat(I.call(e)))},r.prototype.delay=function(t){return this.flatMap(function(n){return e.later(t,n)})},r.prototype.throttle=function(t){return this.flatMapLatest(function(n){return e.later(t,n)})},r.prototype.bufferWithTime=function(t){var n,r,i,s;return s=[],i=function(e){return s.push(e),s.length===1},r=function(){var e;return e=s,s=[],e},n=function(){return e.later(t).map(r)},this.filter(i).flatMap(n)},r.prototype.bufferWithCount=function(e){var t;return t=[],this.withHandler(function(n){var r,i=this;r=function(){return i.push(C(t,n)),t=[]};if(n.isError())return this.push(n);if(n.isEnd())return r(),this.push(n);t.push(n.value);if(t.length===e)return r()})},r.prototype.merge=function(t){var n;return n=this,new r(function(r){var i,s,o,u,a,f;return u=k,a=k,f=!1,o=function(){return u(),a(),f=!0},i=0,s=function(t){var n;return t.isEnd()?(i++,i===2?r(g()):e.more):(n=r(t),n===e.noMore&&o(),n)},u=n.subscribe(s),f||(a=t.subscribe(s)),o})},r.prototype.toProperty=function(e){return arguments.length===0&&(e=f),this.scan(e,x)},r.prototype.toEventStream=function(){return this},r.prototype.concat=function(e){var t;return t=this,new r(function(n){var r;return r=t.subscribe(function(t){return t.isEnd()?r=e.subscribe(n):n(t)}),function(){return r()}})},r.prototype.startWith=function(t){return e.once(t).concat(this)},r.prototype.decorateWith=function(e,t){return t.sampledBy(this,function(t,n){var r;return r=m(n),r[e]=t,r})},r.prototype.mapEnd=function(){var t,n;return n=arguments[0],t=2<=arguments.length?I.call(arguments,1):[],n=T(n,t),this.withHandler(function(t){return t.isEnd()?(this.push(C(n(t))),this.push(g()),e.noMore):this.push(t)})},r.prototype.withHandler=function(e){var t;return t=new n(this.subscribe,e),new r(t.subscribe)},r.prototype.withSubscribe=function(e){return new r(e)},r}(l),c=function(t){function n(t){var r,i=this;this.subscribe=t,this.toEventStream=U(this.toEventStream,this),this.toProperty=U(this.toProperty,this),this.changes=U(this.changes,this),this.sample=U(this.sample,this),n.__super__.constructor.call(this),r=function(t,r,s){var o,u;return o=f,u=f,new n(function(n){var a,f,l,c,h,d,v,m,y,b,w;return w=!1,y=k,b=k,m=function(){return y(),b(),w=!0},c=!1,d=!1,a=function(){var t;if(c&&d)return t=n(g()),t===e.noMore&&m(),t},l=!1,f=function(t,r,i){return function(s){var f;return s.isEnd()?(t(),a(),e.noMore):s.isError()?(f=n(s),f===e.noMore&&m(),f):(r(new p(s.value)),o.isDefined&&u.isDefined?l&&s.isInitial()?e.more:(l=!0,f=i(n,s,o.value,u.value),f===e.noMore&&m(),f):e.more)}},h=f(function(){return c=!0},function(e){return o=e},r),v=f(function(){return d=!0},function(e){return u=e},s),y=i.subscribe(h),w||(b=t.subscribe(v)),m})},this.combine=function(e,t){var n,i;return n=M(t),i=function(e,t,r,i){return e(t.apply(n(r,i)))},r(e,i,i)},this.sampledBy=function(e,t){var n;return t==null&&(t=y),t=M(t),n=function(e,n,r,i){return e(n.apply(t(r,i)))},r(e,k,n).changes().takeUntil(e.filter(!1).mapEnd())}}return R(n,t),n.prototype.sample=function(t){return this.sampledBy(e.interval(t,{}))},n.prototype.changes=function(){var e=this;return new o(function(t){return e.subscribe(function(e){if(!e.isInitial())return t(e)})})},n.prototype.withHandler=function(e){return new n((new h(this.subscribe,e)).subscribe)},n.prototype.withSubscribe=function(e){return new n((new h(e)).subscribe)},n.prototype.toProperty=function(){return this},n.prototype.toEventStream=function(){var e=this;return new o(function(t){return e.subscribe(function(e){return e.isInitial()&&(e=C(e.value)),t(e)})})},n.prototype.and=function(e){return this.combine(e,function(e,t){return e&&t})},n.prototype.or=function(e){return this.combine(e,function(e,t){return e||t})},n.prototype.decode=function(t){return this.combine(e.combineTemplate(t),function(e,t){return t[e]})},n.prototype.delay=function(e){return d(this,this.changes().delay(e))},n.prototype.throttle=function(e){return d(this,this.changes().throttle(e))},n}(l),d=function(t,n){var r;return r=function(t){var n;return n=f,t.subscribe(function(t){return t.isInitial()&&(n=new p(t.value)),e.noMore}),n},n.toProperty(r(t))},n=function(){function t(t,n){var r,i,o,u,a=this;t==null&&(t=function(){return k}),o=[],r=!1,this.hasSubscribers=function(){return o.length>0},u=k,i=function(e){return A(e,o)},this.push=function(t){var n,r,u,f,l,c,h;f=void 0,n=function(){var e,n,r,i;if(f!=null){n=f,f=void 0;for(r=0,i=n.length;r<i;r++)e=n[r],e()}return t.onDone=s.prototype.onDone},t.onDone=function(e){return f!=null&&!j.contains(f,e)?f.push(e):f=[e]},h=v(o);for(l=0,c=h.length;l<c;l++)u=h[l],r=u(t),(r===e.noMore||t.isEnd())&&i(u);return n(),a.hasSubscribers()?e.more:e.noMore},n==null&&(n=function(e){return this.push(e)}),this.handleEvent=function(e){return e.isEnd()&&(r=!0),n.apply(a,[e])},this.subscribe=function(e){return r?(e(g()),k):(o.push(e),o.length===1&&(u=t(a.handleEvent)),function(){i(e);if(!a.hasSubscribers())return u()})}}return t}(),h=function(t){function n(t,r){var i,s,o,u=this;n.__super__.constructor.call(this,t,r),i=f,o=this.push,t=this.subscribe,s=!1,this.push=function(e){return e.isEnd()&&(s=!0),e.hasValue()&&(i=new p(e.value)),o.apply(u,[e])},this.subscribe=function(n){var r,o,a;return r=!1,a=function(){return u.hasSubscribers()||s},o=i.filter(a).map(function(e){return n(b(e))}),o.getOrElse(e.more)===e.noMore?k:s?(n(g()),k):t.apply(u,[n])}}return R(n,t),n}(n),t=function(t){function r(){var t,s,o,u,a,f,l,c,h,p=this;a=void 0,h=[],u=[],s=!1,o=function(t){return function(n){return n.isEnd()?(A(t,u),e.noMore):a(n)}},c=function(){var e,t,n;for(t=0,n=h.length;t<n;t++)e=h[t],e();return h=[]},f=function(e){var t,n,r,i;a=e,h=[],i=v(u);for(n=0,r=i.length;n<r;n++)t=i[n],h.push(t.subscribe(o(t)));return c},t=new n(f),l=function(e){return t.subscribe(e)},r.__super__.constructor.call(this,l),this.plug=function(e){if(s)return;u.push(e);if(a!=null)return h.push(e.subscribe(o(e)))},this.push=function(e){if(a!=null)return a(C(e))},this.error=function(e){if(a!=null)return a(new i(e))},this.end=function(){s=!0,c();if(a!=null)return a(g())}}return R(r,t),r}(o),p=function(){function e(e){this.value=e}return e.prototype.getOrElse=function(){return this.value},e.prototype.get=function(){return this.value},e.prototype.filter=function(t){return t(this.value)?new e(this.value):f},e.prototype.map=function(t){return new e(t(this.value))},e.prototype.forEach=function(e){return e(this.value)},e.prototype.isDefined=!0,e.prototype.toArray=function(){return[this.value]},e}(),f={getOrElse:function(e){return e},filter:function(){return f},map:function(){return f},forEach:function(){},isDefined:!1,toArray:function(){return[]}},e.EventStream=o,e.Property=c,e.Observable=l,e.Bus=t,e.Initial=u,e.Next=a,e.End=r,e.Error=i,k=function(){},x=function(e,t){return t},y=function(e,t){return e},b=function(e){return new u(e)},C=function(e){return new a(e)},g=function(){return new r},w=function(e){return e!=null&&e.isEvent!=null&&e.isEvent()},_=function(e){return w(e)?e:C(e)},v=function(e){return e.slice(0)},m=function(e){var t,n,r;t={};for(n in e)r=e[n],t[n]=r;return t},A=function(e,t){var n;n=t.indexOf(e);if(n>=0)return t.splice(n,1)},S=function(e){return typeof e=="function"},N=function(e,t,n){return n===void 0&&(n=[]),function(r){return e[t].apply(e,n.concat([r]))}},L=function(e,t){return function(n){return e.apply(null,t.concat([n]))}},T=function(e,t){return S(e)?t.length?L(e,t):e:E(e)?D(e,t):typeof e=="object"&&t.length?N(e,j.head(t),j.tail(t)):j.always(e)},E=function(e){return typeof e=="string"&&e.length>1&&e[0]==="."},D=function(e,t){var n,r;return r=e.slice(1).split("."),n=j.map(B(t),r),function(t){var r,i;for(r=0,i=n.length;r<i;r++)e=n[r],t=e(t);return t}},B=function(e){return function(t){return function(n){var r;return r=n[t],S(r)?r.apply(n,e):r}}},P=function(e){return e.slice(1)},M=function(e){var t;if(S(e))return e;if(E(e))return t=P(e),function(e,n){return e[t](n)}},H=function(e){return e instanceof p||e===f?e:new p(e)},typeof define!="undefined"&&define!==null&&define.amd!=null&&typeof define=="function"&&define(function(){return e}),j={head:function(e){return e[0]},always:function(e){return function(){return e}},empty:function(e){return e.length===0},tail:function(e){return e.slice(1,e.length)},filter:function(e,t){var n,r,i,s;n=[];for(i=0,s=t.length;i<s;i++)r=t[i],e(r)&&n.push(r);return n},map:function(e,t){var n,r,i,s;s=[];for(r=0,i=t.length;r<i;r++)n=t[r],s.push(e(n));return s},each:function(e,t){var n,r,i;i=[];for(n in e)r=e[n],i.push(t(n,r));return i},contains:function(e,t){return e.indexOf(t)>=0},id:function(e){return e},last:function(e){return e[e.length-1]}},e._=j}).call(this);